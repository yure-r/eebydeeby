{"ast":null,"code":"import _classCallCheck from\"/Users/richardyurewitch/Downloads/emojibuilder-master 3/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/richardyurewitch/Downloads/emojibuilder-master 3/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/richardyurewitch/Downloads/emojibuilder-master 3/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/richardyurewitch/Downloads/emojibuilder-master 3/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React,{Component}from'react';import'./Canvas.css';var App;var Canvas=/*#__PURE__*/function(_Component){_inherits(Canvas,_Component);var _super=_createSuper(Canvas);function Canvas(props){var _this;_classCallCheck(this,Canvas);_this=_super.call(this,props);_this.mainCanvas=/*#__PURE__*/React.createRef();_this.smallCanvas=/*#__PURE__*/React.createRef();_this.draw=function(){var base=App.findBaseLayer();_this.ctx.clearRect(0,0,App.config.compSize,App.config.compSize);App.state.layers.forEach(function(layer){if(!layer.asset.base&&base){if(base.asset.translate){_this.ctx.translate(App.config.compSize*base.asset.translate[0],App.config.compSize*base.asset.translate[1]);}if(base.asset.scale){_this.ctx.scale(base.asset.scale,base.asset.scale);}}_this.ctx.translate(App.config.compSize/2,App.config.compSize/2);_this.ctx.scale(parseFloat(layer.transform.scale),parseFloat(layer.transform.scale));_this.ctx.rotate(parseFloat(layer.transform.rotate)*Math.PI/180);_this.ctx.translate(-App.config.compSize/2,-App.config.compSize/2);_this.ctx.translate(parseFloat(layer.transform.translateX),parseFloat(layer.transform.translateY));if(layer.flipped){_this.ctx.scale(-1,1);_this.ctx.drawImage(layer.asset.img,-App.config.compSize,0);}else{_this.ctx.drawImage(layer.asset.img,0,0);}_this.ctx.resetTransform();});_this.smallCanvas.current.getContext('2d').drawImage(_this.mainCanvas.current,0,0);};App=_this.props.app;return _this;}_createClass(Canvas,[{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",{className:\"Canvas\"},/*#__PURE__*/React.createElement(\"canvas\",{className:\"main\",ref:this.mainCanvas}),/*#__PURE__*/React.createElement(\"canvas\",{className:\"small\",ref:this.smallCanvas}));}},{key:\"componentDidMount\",value:function componentDidMount(nextProps,nextState){[this.mainCanvas,this.smallCanvas].forEach(function(canvas){canvas.current.width=App.config.compSize;canvas.current.height=App.config.compSize;});this.ctx=this.mainCanvas.current.getContext('2d');this.smallCanvas.current.getContext('2d').globalCompositeOperation='copy';this.draw();}},{key:\"componentDidUpdate\",value:function componentDidUpdate(nextProps,nextState){this.draw();}}]);return Canvas;}(Component);export default Canvas;","map":{"version":3,"names":["React","Component","App","Canvas","props","mainCanvas","createRef","smallCanvas","draw","base","findBaseLayer","ctx","clearRect","config","compSize","state","layers","forEach","layer","asset","translate","scale","parseFloat","transform","rotate","Math","PI","translateX","translateY","flipped","drawImage","img","resetTransform","current","getContext","app","nextProps","nextState","canvas","width","height","globalCompositeOperation"],"sources":["/Users/richardyurewitch/Downloads/emojibuilder-master 3/src/Canvas.js"],"sourcesContent":["import React, { Component } from 'react';\nimport './Canvas.css';\n\nlet App;\n\nclass Canvas extends Component {\n  mainCanvas = React.createRef();\n  smallCanvas = React.createRef();\n\n  constructor(props) {\n    super(props);\n    App = this.props.app;\n  }\n\n  render() {\n    return (\n      <div className='Canvas'>\n        <canvas className='main' ref={this.mainCanvas}></canvas>\n        <canvas className='small' ref={this.smallCanvas}></canvas>\n      </div>\n    );\n  }\n\n  componentDidMount(nextProps, nextState) {\n    [this.mainCanvas, this.smallCanvas].forEach(canvas => {\n      canvas.current.width = App.config.compSize;\n      canvas.current.height = App.config.compSize;\n    })\n\n    this.ctx = this.mainCanvas.current.getContext('2d');\n    this.smallCanvas.current.getContext('2d').globalCompositeOperation = 'copy';\n\n    this.draw();\n  }\n\n  componentDidUpdate(nextProps, nextState) {\n    this.draw();\n  }\n\n  draw = () => {\n    const base = App.findBaseLayer();\n  \n    this.ctx.clearRect(0, 0, App.config.compSize, App.config.compSize);\n  \n    App.state.layers.forEach(layer => {\n      if (!layer.asset.base && base) {\n        if (base.asset.translate) {\n          this.ctx.translate(\n            App.config.compSize * base.asset.translate[0], \n            App.config.compSize * base.asset.translate[1]\n          );\n        }\n        if (base.asset.scale) {\n          this.ctx.scale(base.asset.scale, base.asset.scale);\n        }\n      }\n  \n      this.ctx.translate(App.config.compSize/2, App.config.compSize/2);\n      this.ctx.scale(parseFloat(layer.transform.scale), parseFloat(layer.transform.scale));\n      this.ctx.rotate(parseFloat(layer.transform.rotate) * Math.PI / 180);\n      this.ctx.translate(-App.config.compSize/2, -App.config.compSize/2);\n      this.ctx.translate(parseFloat(layer.transform.translateX), parseFloat(layer.transform.translateY));\n  \n      if (layer.flipped) {\n        this.ctx.scale(-1, 1);\n        this.ctx.drawImage(layer.asset.img, -App.config.compSize, 0);\n      } else {\n        this.ctx.drawImage(layer.asset.img, 0, 0);\n      }\n  \n      this.ctx.resetTransform();\n    });\n\n    this.smallCanvas.current.getContext('2d').drawImage(this.mainCanvas.current, 0, 0);\n  }\n}\n\nexport default Canvas;"],"mappings":"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"},"metadata":{},"sourceType":"module"}